# gRPC Image Service

Сервис для загрузки, хранения и скачивания изображений с использованием gRPC.

## Особенности

- **Потоковая передача данных**: Эффективная загрузка и скачивание файлов любого размера
- **Сжатие файлов**: Автоматическое сжатие загружаемых файлов для экономии дискового пространства
- **Ограничение одновременных подключений**: Защита от перегрузки сервера
- **Кросс-платформенность**: Работает как на Windows, так и на Linux
- **Простой CLI-интерфейс**: Удобное управление через командную строку

## Требования

- Go 1.18 или выше
- Protocol Buffers компилятор (protoc)
- Make (опционально, для использования Makefile)

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/k1raz/grpc-image-service.git
   cd grpc-image-service
   ```

2. Установите зависимости:
   ```bash
   make deps
   ```

3. Создайте директорию для хранения файлов:
   ```bash
   make create-storage
   ```

4. Запустите сервер:
   ```bash
   make run-server
   ```

5. Запустите клиент:
   ```bash
   make run-client
   ```

6. Загрузите файл:
   ```bash
   make upload-file FILE=path/to/your/image.jpg
   ```

7. Скачайте файл:
   ```bash
   make download-file FILE=path/to/your/image.jpg SAVE=path/to/save/image.jpg
   ```

8. Просмотрите список файлов:
   ```bash
   make list-files
   ```

## С параметрами по умолчанию
```bash
make run-server
```


### Параметры клиента

- `-server`: Адрес gRPC сервера (по умолчанию `localhost:50051`)
- `-upload`: Путь к файлу для загрузки
- `-download`: Имя файла для скачивания
- `-save`: Путь для сохранения скачанного файла
- `-list`: Получить список файлов на сервере

## Архитектура

### Сервер

- **cmd/server/main.go**: Точка входа сервера
- **internal/service/file_service.go**: Реализация сервиса для работы с файлами
- **internal/limiter/limiter.go**: Ограничитель одновременных подключений
- **internal/config/config.go**: Конфигурация сервера

### Клиент

- **cmd/client/client.go**: Клиентское приложение для взаимодействия с сервером

### Протокол

- **pkg/api/file.proto**: Определение gRPC сервиса и сообщений

## Реализованные фичи

1. **Потоковая передача данных**:
   - Клиентский стриминг для загрузки файлов
   - Серверный стриминг для скачивания файлов

2. **Ограничение одновременных подключений**:
   - 10 конкурентных запросов для загрузки/скачивания файлов
   - 100 конкурентных запросов для просмотра списка файлов

3. **Метаданные файлов**:
   - Хранение информации о файлах (имя, дата создания, дата обновления)
   - Отображение списка файлов с метаданными

4. **Обработка ошибок**:
   - Проверка существования файлов
   - Корректная обработка ошибок при загрузке/скачивании

5. **Кросс-платформенная сборка**:
   - Автоматическое определение операционной системы
   - Корректная работа на Windows и Linux
